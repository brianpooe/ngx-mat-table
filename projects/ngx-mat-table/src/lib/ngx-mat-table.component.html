<mat-form-field style="padding-left: 2em;">
  <input matInput placeholder="Search" />
</mat-form-field>

<div class="mat-elevation-z8">
  <mat-table [dataSource]="dataSource" matSort matSortDisableClear="true">
    <ng-container
      *ngFor="let col of tableCols; let i = index"
      [matColumnDef]="col.key"
    >
      <mat-header-cell *matHeaderCellDef>{{
        tableCols[i]["display"]
      }}</mat-header-cell>
      <mat-cell *matCellDef="let element">
        <!-- Checking if it's a normal column or column with specific config -->
        <ng-container *ngIf="!col.config; else hasConfig">
          {{ element[col.key] }}
        </ng-container>
        <!-- If this column has a config object so we will display depending
  on our setted config -->
        <ng-template #hasConfig>
          <!-- if this attribute is a date, we will format it depending on format
      value in config object -->
          <ng-container *ngIf="col.config.isDate">
            {{ element[col.key] | date: col.config.format }}
          </ng-container>
          <!-- if this column is action, we will loop through each action and show
      it as a mat-button -->
          <ng-container *ngIf="col.config.isAction">
            <button
              mat-icon-button
              color="warn"
              style="margin: 5px;"
              *ngFor="let action of col.config.actions"
              (click)="emitAction(action)"
              attr.aria-label="{{ action }}"
            >
              <mat-icon> {{ action }}_outline</mat-icon>
            </button>
          </ng-container>
        </ng-template>
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="noData">
      <mat-cell
        class="no-data-cell"
        *matCellDef="let element"
        [attr.colspan]="keys.length"
      >
        <ng-container *ngIf="!(error$ | async) && !loading">
          <span>No Data</span>
        </ng-container>
        <ng-container *ngIf="(error$ | async) && !loading">
          <span>System Failure</span>
          <span>Error</span>
          <span class="retry" (click)="retry()">Retry</span>
        </ng-container>
        <ng-container *ngIf="loading">
          <span>Retrieving data...</span>
        </ng-container>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="keys; sticky: true"></mat-header-row>
    <ng-container *ngIf="total && !loading">
      <mat-row *matRowDef="let row; columns: keys"></mat-row>
    </ng-container>
    <ng-container *ngIf="!total || loading">
      <mat-row
        *matRowDef="let row; columns: ['noData']"
        class="no-data-row"
      ></mat-row>
    </ng-container>
  </mat-table>

  <mat-paginator
    [length]="total"
    [pageSize]="pageSize"
    [pageSizeOptions]="pageSizeOptions"
  ></mat-paginator>
</div>
